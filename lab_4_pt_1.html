<!DOCTYPE html>
<html>
<head>
<title>Demo querystring</title>
<style>
	pre { background-color: beige;}
	#resultat {
		border: 1px solid black;
		background-color: #eeeeee;
	}
</style>
<script>
let p = new Promise( function(success, fail) {
		let request = new XMLHttpRequest();
		request.open('GET', 'http://forverkliga.se/JavaScript/api/ajax-lab.php');
	request.onreadystatechange = function(event) {
		  console.log('readyState: ' + request.readyState +
					 ', status: ' + request.status);
		  console.log('responseText: '+request.responseText);
		  
		  // om readyState==4, skriv ut resultatet
		  if( request.readyState == 4 && request.status == 200 ) {
			// success - när servern har returnerat data till oss
			success(request.responseText);				
		  } else if( request.status < 200 || request.status > 299 ) {
			fail('Something went wrong. status==' + request.status);
		  }
		};
		request.send();
	} );  
	
	p.then(
		function(data) { // onSuccess
			let div = document.getElementById('resultat');
			let obj = JSON.parse(data);
			div.innerHTML = 'Meddelandet ' +
				obj.message;
		},
		/*function(errorMessage) { // onFailure
			let div = document.getElementById('resultat');
			div.innerHTML = 'Något gick fel: ' + errorMessage;*/
		}
	);
	//console.log(request)
</script>


</head>
<body>
<div id="resultat">
Resultatet kommer här...

</div>


</body>
</html>
